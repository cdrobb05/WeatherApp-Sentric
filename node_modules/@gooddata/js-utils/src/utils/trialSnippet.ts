// (C) 2007-2018 GoodData Corporation
import { loadScript } from './load-script';

export const DEVELOPMENT_SNIPPET = 'https://gd-trial-manager-dev.herokuapp.com/assets/scripts/trial.js';

export const PRODUCTION_SNIPPET = 'https://gd-trial-manager-prod.herokuapp.com/assets/scripts/trial.js';

function generateFinalUrl(environment: string): string | null {
    if (environment === 'dev') {
        return DEVELOPMENT_SNIPPET;
    } else if (environment === 'prod') {
        return PRODUCTION_SNIPPET;
    } else {
        return null;
    }
}

export function load(environment: string | undefined): Promise<any> {
    if (!environment) { return Promise.resolve(); }

    const url = generateFinalUrl(environment);

    if (!url) { return Promise.resolve(); }

    return loadScript(url) // load trial snippet script
        .catch(() => {
            // tslint:disable-next-line:no-console
            console.log(`Error loading trial snippet. Please check the presence of ${url}`);
        });
}
